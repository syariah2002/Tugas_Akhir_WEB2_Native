var MyBB={init:function(){return $(function(){MyBB.pageLoaded()}),!0},pageLoaded:function(){expandables.init(),$('[name="allbox"]').each(function(a,b){$(this).change(function(){var a=$(this).closest("form").find(":checkbox");$(this).is(":checked")?a.prop("checked",!0):a.removeAttr("checked")})});var a=$(".initial_focus");a.length&&a.focus(),"undefined"!=typeof use_xmlhttprequest&&1==use_xmlhttprequest&&(mark_read_imgs=$(".ajax_mark_read"),mark_read_imgs.each(function(){var a=$(this);a.hasClass("forum_off")||a.hasClass("forum_offlock")||a.hasClass("forum_offlink")||a.hasClass("subforum_minioff")||a.hasClass("subforum_miniofflock")||a.hasClass("subforum_miniofflink")||a.attr("title")&&a.attr("title")==lang.no_new_posts||(a.click(function(){MyBB.markForumRead(this)}),a.css("cursor","pointer"),a.attr("title")&&a.attr("title",a.attr("title")+" - "),a.attr("title",a.attr("title")+lang.click_mark_read))})),"undefined"!=typeof $.modal&&($(document).on($.modal.OPEN,function(b,c){$("body").css("overflow","hidden"),a.length>0&&a.focus()}),$(document).on($.modal.CLOSE,function(a,b){$("body").css("overflow","auto")}))},popupWindow:function(a,b,c){b||(b={fadeDuration:250,zIndex:"undefined"!=typeof modal_zindex?modal_zindex:9999}),1!=c&&(a=rootpath+a),$.get(a,function(a){$(a).appendTo("body").modal(b)})},deleteEvent:function(a){$.prompt(deleteevent_confirm,{buttons:[{title:yes_confirm,value:!0},{title:no_confirm,value:!1}],submit:function(b,c,d,e){if(1==c){var f=$("<form />",{method:"post",action:"calendar.php",style:"display: none;"});f.append($("<input />",{name:"action",type:"hidden",value:"do_deleteevent"})),my_post_key&&f.append($("<input />",{name:"my_post_key",type:"hidden",value:my_post_key})),f.append($("<input />",{name:"eid",type:"hidden",value:a})),f.append($("<input />",{name:"delete",type:"hidden",value:1})),$("body").append(f),f.submit()}}})},reputation:function(a,b){if(!b)var b=0;MyBB.popupWindow("/reputation.php?action=add&uid="+a+"&pid="+b+"&modal=1")},viewNotes:function(a){MyBB.popupWindow("/member.php?action=viewnotes&uid="+a+"&modal=1")},deleteReputation:function(a,b){return $.prompt(delete_reputation_confirm,{buttons:[{title:yes_confirm,value:!0},{title:no_confirm,value:!1}],submit:function(c,d,e,f){if(1==d){var g=$("<form />",{method:"post",action:"reputation.php?action=delete",style:"display: none;"});g.append($("<input />",{name:"rid",type:"hidden",value:b})),my_post_key&&g.append($("<input />",{name:"my_post_key",type:"hidden",value:my_post_key})),g.append($("<input />",{name:"uid",type:"hidden",value:a})),$("body").append(g),g.submit()}}}),!1},whoPosted:function(a){MyBB.popupWindow("/misc.php?action=whoposted&tid="+a+"&modal=1")},markForumRead:function(a){var b=$(a);if(!b.length)return!1;var c=b.attr("id").replace("mark_read_","");return!!c&&void $.ajax({url:"misc.php?action=markread&fid="+c+"&ajax=1&my_post_key="+my_post_key,async:!0,success:function(a){MyBB.forumMarkedRead(c,a)}})},forumMarkedRead:function(a,b){if(1==b){var c=$("#mark_read_"+a);c.hasClass("subforum_minion")?c.removeClass("subforum_minion").addClass("subforum_minioff"):c.removeClass("forum_on").addClass("forum_off"),c.css("cursor","default").attr("title",lang.no_new_posts)}},unHTMLchars:function(a){return a=a.replace(/&lt;/g,"<"),a=a.replace(/&gt;/g,">"),a=a.replace(/&nbsp;/g," "),a=a.replace(/&quot;/g,'"'),a=a.replace(/&amp;/g,"&")},HTMLchars:function(a){return a=a.replace(new RegExp("&(?!#[0-9]+;)","g"),"&amp;"),a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;"),a=a.replace(/"/g,"&quot;")},changeLanguage:function(){return form=$("#lang_select"),!!form.length&&void form.submit()},changeTheme:function(){return form=$("#theme_select"),!!form.length&&void form.submit()},detectDSTChange:function(a){var b=new Date,c=b.getTimezoneOffset()/60;1==Math.abs(parseInt(a)+c)&&$.ajax({url:"misc.php?action=dstswitch&ajax=1",async:!0,method:"post",error:function(a){if(1!=use_xmlhttprequest){var b=$("<form />",{method:"post",action:"misc.php",style:"display: none;"});b.append($("<input />",{name:"action",type:"hidden",value:"dstswitch"})),$("body").append(b),b.submit()}}})},dismissPMNotice:function(a){var b=$("#pm_notice");return!!b.length&&(1!=use_xmlhttprequest||($.ajax({type:"post",url:a+"private.php?action=dismiss_notice",data:{ajax:1,my_post_key:my_post_key},async:!0}),b.remove(),!1))},submitReputation:function(a,b,c){var d=$(".reputation_"+a+"_"+b).serialize();return 1==c&&(d+="&delete=1"),$.ajax({type:"POST",url:"reputation.php?modal=1",data:d,dataType:"html",success:function(c){$(".modal_"+a+"_"+b).fadeOut("slow",function(){$(".modal_"+a+"_"+b).html(c),$(".modal_"+a+"_"+b).fadeIn("slow"),$(".modal").fadeIn("slow")})},error:function(){alert(lang.unknown_error)}}),!1},deleteAnnouncement:function(a){return $.prompt(announcement_quickdelete_confirm,{buttons:[{title:yes_confirm,value:!0},{title:no_confirm,value:!1}],submit:function(b,c,d,e){1==c&&(window.location=a.href.replace("action=delete_announcement","action=do_delete_announcement"))}}),!1},select2:function(){"undefined"!=typeof $.fn.select2&&$.extend($.fn.select2.defaults,{formatMatches:function(a){return 1==a?lang.select2_match:lang.select2_matches.replace("{1}",a)},formatNoMatches:function(){return lang.select2_nomatches},formatInputTooShort:function(a,b){var c=b-a.length;return 1==c?lang.select2_inputtooshort_single:lang.select2_inputtooshort_plural.replace("{1}",c)},formatInputTooLong:function(a,b){var c=a.length-b;return 1==c?lang.select2_inputtoolong_single:lang.select2_inputtoolong_plural.replace("{1}",c)},formatSelectionTooBig:function(a){return 1==a?lang.select2_selectiontoobig_single:lang.select2_selectiontoobig_plural.replace("{1}",a)},formatLoadMore:function(a){return lang.select2_loadmore},formatSearching:function(){return lang.select2_searching}})}},Cookie={get:function(a){return a=cookiePrefix+a,$.cookie(a)},set:function(a,b,c){return a=cookiePrefix+a,c||(c=31536e4),expire=new Date,expire.setTime(expire.getTime()+1e3*c),options={expires:expire,path:cookiePath,domain:cookieDomain},$.cookie(a,b,options)},unset:function(a){return a=cookiePrefix+a,options={path:cookiePath,domain:cookieDomain},$.removeCookie(a,options)}},expandables={init:function(){var a=$(".expcolimage .expander");a.length&&a.each(function(){var a=$(this);0!=a.attr("id")&&(a.click(function(){controls=a.attr("id").replace("_img",""),expandables.expandCollapse(this,controls)}),"ie"==MyBB.browser?a.css("cursor","hand"):a.css("cursor","pointer"))})},expandCollapse:function(a,b){if(element=$(a),!element||0==b)return!1;var c=$("#"+b+"_e"),d=$("#"+b+"_c");return c.length&&d.length?c.is(":hidden")?(c.toggle("fast"),d.toggle("fast"),this.saveCollapsed(b)):(c.toggle("fast"),d.toggle("fast"),this.saveCollapsed(b,1)):c.length&&!d.length&&(c.is(":hidden")?(c.toggle("fast"),element.attr("src",element.attr("src").replace(/collapse_collapsed\.(gif|jpg|jpeg|bmp|png)$/i,"collapse.$1")).attr("alt","[-]").attr("title","[-]"),element.parent().parent("td").removeClass("tcat_collapse_collapsed"),element.parent().parent(".thead").removeClass("thead_collapsed"),this.saveCollapsed(b)):(c.toggle("fast"),element.attr("src",element.attr("src").replace(/collapse\.(gif|jpg|jpeg|bmp|png)$/i,"collapse_collapsed.$1")).attr("alt","[+]").attr("title","[+]"),element.parent().parent("td").addClass("tcat_collapse_collapsed"),element.parent().parent(".thead").addClass("thead_collapsed"),this.saveCollapsed(b,1))),!0},saveCollapsed:function(a,b){var c=[],d=[],e=Cookie.get("collapsed");e&&(c=e.split("|"),$.each(c,function(b,c){c!=a&&""!=c&&(d[d.length]=c)})),1==b&&(d[d.length]=a),Cookie.set("collapsed",d.join("|"))}},lang={};!function(a){"undefined"!=typeof a.modal&&(a.modal.defaults.keepelement=!1,a.modal.prototype.oldCloseFunction=a.modal.prototype.close,a.modal.prototype.close=function(){this.oldCloseFunction(),this.options.keepelement||this.$elm.remove()})}(jQuery),MyBB.init();